import{r as o,j as e,B as j}from"./index-RDm8gRJE.js";function f(){const[i,x]=o.useState(""),[r,n]=o.useState(null),[c,d]=o.useState(!1),[u,l]=o.useState(""),h=async()=>{if(!i.trim()){l("Введите SQL-запрос"),n(null);return}const s=localStorage.getItem("authToken");if(!s){l("Пользователь не авторизован"),n(null);return}d(!0),l(""),n(null);try{const a=await(await fetch("/api/sql-explorer/execute",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({sql:i})})).json();a.error?l(a.error):n(a.rows||`Изменено строк: ${a.affectedRows??0}`)}catch(t){l("Ошибка выполнения запроса: "+t.message)}finally{d(!1)}};return e.jsxs("div",{className:"aam_sql-explorer",children:[e.jsx("h2",{className:"aam_sql-title",children:"SQL Explorer"}),e.jsx("textarea",{className:"aam_sql-textarea",value:i,onChange:s=>x(s.target.value),placeholder:"Введите SQL-запрос"}),e.jsx("div",{className:"aam_sql-actions",children:e.jsx(j,{type:"submit",variant:"white",label:c?"Выполнение...":"Выполнить",onClick:h,disabled:c})}),u&&e.jsx("p",{className:"aam_sql-error",children:u}),r&&e.jsx("div",{className:"aam_sql-result",children:Array.isArray(r)?e.jsxs("table",{className:"aam_sql-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:Object.keys(r[0]||{}).map((s,t)=>e.jsx("th",{children:s},t))})}),e.jsx("tbody",{children:r.map((s,t)=>e.jsx("tr",{children:Object.values(s).map((a,m)=>e.jsx("td",{children:a===null?"NULL":String(a)},m))},t))})]}):e.jsx("p",{children:r})})]})}export{f as default};
//# sourceMappingURL=SQLExplorer-f0nUKV59.js.map
