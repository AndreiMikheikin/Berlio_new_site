import{j as a,N as p,P as t,r as i,u as x,O as b,H as j}from"./index-RDm8gRJE.js";import{u as f}from"./useTranslation-D2ryNk2k.js";function c({items:e}){return a.jsx("nav",{className:"aam_admin-menu",children:a.jsx("ul",{className:"aam_admin-menu__list",children:e.map(({label:o,to:s})=>a.jsx("li",{className:"aam_admin-menu__item",children:a.jsx(p,{to:s,end:!0,className:({isActive:d})=>`aam_admin-menu__link${d?" aam_admin-menu__link--active":""}`,children:o})},s))})})}c.propTypes={items:t.arrayOf(t.shape({label:t.string.isRequired,to:t.string.isRequired})).isRequired};function g(){const[e,o]=i.useState(""),[s,d]=i.useState(""),[h,u]=i.useState(!0),r=x();if(i.useEffect(()=>{(async()=>{const m=localStorage.getItem("authToken");if(!m){r("/administrator");return}try{const n=await fetch("/api/admin/secure",{headers:{Authorization:`Bearer ${m}`}});if(n.status===401)throw new Error("Unauthorized");if(!n.ok)throw new Error("Ошибка сервера");const l=await n.json();o(l.message),d(l.role)}catch{localStorage.removeItem("authToken"),r("/administrator")}finally{u(!1)}})()},[r]),h)return a.jsx("p",{className:"aam_admin-dashboard__loading",children:"Загрузка..."});const _=[{label:"Панель управления",to:"/adminDashboard"},{label:"Администраторы",to:"/adminDashboard/users"},{label:"Новости",to:"/adminDashboard/news"},{label:"SQL Explorer",to:"/adminDashboard/sql-explorer"},{label:"Настройки",to:"/adminDashboard/settings"}];return a.jsxs("section",{className:"aam_admin-dashboard",children:[a.jsxs("header",{className:"aam_admin-dashboard__header",children:[a.jsx("p",{className:"aam_admin-dashboard__welcome",children:e}),a.jsx("p",{className:"aam_admin-dashboard__role",children:s}),a.jsx("button",{className:"aam_admin-dashboard__logout",onClick:()=>{localStorage.removeItem("authToken"),r("/administrator")},children:"Выход"})]}),a.jsxs("div",{className:"aam_admin-dashboard__wrapper",children:[a.jsx("aside",{className:"aam_admin-dashboard__wrapper-tools",children:a.jsx(c,{items:_})}),a.jsx("main",{className:"aam_admin-dashboard__wrapper-outlet",children:a.jsx(b,{context:{role:s}})})]})]})}function k(){const{t:e}=f();return a.jsxs("div",{className:"aam_admin-dashboard-page",children:[a.jsxs(j,{children:[a.jsx("title",{children:e("pageTitles.adminDashboard")}),a.jsx("meta",{name:"description",content:e("adminDashboard.pageDescription")})]}),a.jsx(g,{})]})}export{k as default};
//# sourceMappingURL=AdminDashboardPage-BFq2PClU.js.map
