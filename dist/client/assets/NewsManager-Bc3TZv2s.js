const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/quill-Cj_AQspS.js","assets/index-HWUfzzpA.js","assets/index-BXaW5Mvo.css"])))=>i.map(i=>d[i]);
import{r as s,_ as A,j as e,B as C,n as B}from"./index-HWUfzzpA.js";import{s as $}from"./slugify-DOqBg0Ac.js";/* empty css                    */function T({value:n,onChange:d,placeholder:u=""}){const h=s.useRef(null),o=s.useRef(null);return s.useEffect(()=>{let i;if(h.current)return A(async()=>{const{default:m}=await import("./quill-Cj_AQspS.js");return{default:m}},__vite__mapDeps([0,1,2])).then(({default:m})=>{i=new m(h.current,{theme:"snow",placeholder:u,modules:{toolbar:[[{header:[2,3,4,!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],[{color:["#48AE5A","#F24942","#000000","#FFFFFF",!1]}],[{background:["#48AE5A","#F24942","#000000","#FFFFFF",!1]}],[{align:[]}],["clean"]]}}),n&&i.clipboard.dangerouslyPasteHTML(n),i.on("text-change",()=>{const _=i.root.innerHTML;d(_)}),o.current=i}),()=>{o.current&&(o.current.off("text-change"),o.current=null,i=null)}},[]),s.useEffect(()=>{o.current&&n!==o.current.root.innerHTML&&o.current.clipboard.dangerouslyPasteHTML(n||"")},[n]),e.jsx("div",{className:"custom-quill-editor",ref:h})}function L({onClose:n,onCreated:d}){const[u,h]=s.useState(""),[o,i]=s.useState("B"),[m,_]=s.useState(""),[y,p]=s.useState(""),[f,j]=s.useState(""),[x,N]=s.useState({ru:"",en:""}),[c,r]=s.useState({ru:"",en:""}),[g,w]=s.useState(!1),[S,b]=s.useState("");s.useEffect(()=>{if(!u.trim()){const a=x.ru||x.en;a.trim()&&h($(a,{lower:!0,strict:!0}))}},[x.ru,x.en]);const D=async()=>{w(!0),b("");const a={slug:u,priority:o,dates:{date:m,startDate:y,expireDate:f},titles:x,descriptions:c};try{const t=localStorage.getItem("authToken"),l=await fetch("/api/admin/news",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(a)});if(!l.ok){const v=await l.json();throw new Error(v?.error||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾ÑÑ‚Ð¸")}d(),n()}catch(t){b(t.message)}finally{w(!1)}},E=(a,t)=>{N(l=>({...l,[a]:t}))},k=(a,t)=>{r(l=>({...l,[a]:t}))};return e.jsx("div",{className:"aam_modal",children:e.jsxs("div",{className:"aam_modal__content",children:[e.jsx("h3",{className:"aam_modal__title",children:"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ð¾ÑÑ‚ÑŒ"}),S&&e.jsx("p",{className:"aam_modal__error",children:S}),e.jsx("input",{className:"aam_modal__input",type:"text",placeholder:"ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð¸Ð· Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ°",value:u,onChange:a=>h(a.target.value)}),e.jsxs("select",{className:"aam_modal__input",value:o,onChange:a=>i(a.target.value),children:[e.jsx("option",{value:"A",children:"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ A"}),e.jsx("option",{value:"B",children:"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ B"})]}),e.jsxs("label",{htmlFor:"publishDate",children:["Ð”Ð°Ñ‚Ð° Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸",e.jsx("input",{className:"aam_modal__input",type:"date",id:"publishDate",value:m,onChange:a=>_(a.target.value)})]}),e.jsxs("label",{htmlFor:"startDate",children:["ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",e.jsx("input",{className:"aam_modal__input",type:"date",id:"startDate",value:y,onChange:a=>p(a.target.value)})]}),e.jsxs("label",{htmlFor:"expireDate",children:["ÐšÐ¾Ð½ÐµÑ† Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",e.jsx("input",{className:"aam_modal__input",type:"date",id:"expireDate",value:f,onChange:a=>j(a.target.value)})]}),e.jsx("hr",{className:"aam_modal__divider"}),["ru","en"].map(a=>e.jsxs("div",{children:[e.jsxs("h4",{children:["Ð¯Ð·Ñ‹Ðº: ",a.toUpperCase()]}),e.jsx("input",{className:"aam_modal__input",type:"text",placeholder:`Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº (${a})`,value:x[a],onChange:t=>E(a,t.target.value)}),e.jsx(T,{value:c[a],onChange:t=>k(a,t),placeholder:`ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ (${a})`})]},a)),e.jsxs("div",{className:"aam_modal__actions",children:[e.jsx(C,{type:"submit",variant:"green",label:g?"Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ...":"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ",onClick:D,disabled:g}),e.jsx(C,{type:"reset",variant:"green",label:"ÐžÑ‚Ð¼ÐµÐ½Ð°",onClick:n})]})]})})}function M({news:n,onClose:d,onUpdated:u}){const[h,o]=s.useState(n.slug),[i,m]=s.useState(n.priority),[_,y]=s.useState(n.dates?.date||""),[p,f]=s.useState(n.dates?.startDate||""),[j,x]=s.useState(n.dates?.expireDate||""),[N,c]=s.useState(n.titles||{ru:"",en:""}),[r,g]=s.useState(n.descriptions||{ru:"",en:""}),[w,S]=s.useState(!1),[b,D]=s.useState(""),E=async()=>{S(!0),D("");const t={slug:h,priority:i,dates:{date:_,startDate:p,expireDate:j},titles:N,descriptions:r};try{const l=localStorage.getItem("authToken"),v=await fetch(`/api/admin/news/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(t)});if(!v.ok){const F=await v.json();throw new Error(F?.error||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ")}u(),d()}catch(l){D(l.message)}finally{S(!1)}},k=(t,l)=>{c(v=>({...v,[t]:l}))},a=(t,l)=>{g(v=>({...v,[t]:l}))};return e.jsx("div",{className:"aam_modal",children:e.jsxs("div",{className:"aam_modal__content",children:[e.jsx("h3",{className:"aam_modal__title",children:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ð¾ÑÑ‚ÑŒ"}),b&&e.jsx("p",{className:"aam_modal__error",children:b}),e.jsx("input",{className:"aam_modal__input",type:"text",placeholder:"Slug",value:h,onChange:t=>o(t.target.value)}),e.jsxs("select",{className:"aam_modal__input",value:i,onChange:t=>m(t.target.value),children:[e.jsx("option",{value:"A",children:"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ A"}),e.jsx("option",{value:"B",children:"ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ B"})]}),e.jsx("input",{className:"aam_modal__input",type:"date",placeholder:"Ð”Ð°Ñ‚Ð° Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸",value:_,onChange:t=>y(t.target.value)}),e.jsx("input",{className:"aam_modal__input",type:"date",placeholder:"ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",value:p,onChange:t=>f(t.target.value)}),e.jsx("input",{className:"aam_modal__input",type:"date",placeholder:"ÐšÐ¾Ð½ÐµÑ† Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",value:j,onChange:t=>x(t.target.value)}),e.jsx("hr",{className:"aam_modal__divider"}),["ru","en"].map(t=>e.jsxs("div",{children:[e.jsxs("h4",{children:["Ð¯Ð·Ñ‹Ðº: ",t.toUpperCase()]}),e.jsx("input",{className:"aam_modal__input",type:"text",placeholder:`Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº (${t})`,value:N[t],onChange:l=>k(t,l.target.value)}),e.jsx(T,{value:r[t],onChange:l=>a(t,l),placeholder:`ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ (${t})`})]},t)),e.jsxs("div",{className:"aam_modal__actions",children:[e.jsx(C,{type:"submit",variant:"green",label:w?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...":"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",onClick:E,disabled:w}),e.jsx(C,{type:"reset",variant:"green",label:"ÐžÑ‚Ð¼ÐµÐ½Ð°",onClick:d})]})]})})}function P({onConfirm:n,onCancel:d,title:u}){return e.jsx("div",{className:"aam_modal",children:e.jsxs("div",{className:"aam_modal__content",children:[e.jsx("h3",{className:"aam_modal__title",children:"Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ð¾ÑÑ‚Ð¸"}),e.jsxs("p",{className:"aam_modal__text",children:["Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ð¾ÑÑ‚ÑŒ ",e.jsx("strong",{children:u}),"?"]}),e.jsxs("div",{className:"aam_modal__actions",children:[e.jsx(C,{type:"submit",label:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ",variant:"danger",onClick:n}),e.jsx(C,{type:"reset",label:"ÐžÑ‚Ð¼ÐµÐ½Ð°",variant:"green",onClick:d})]})]})})}function O(){const{role:n}=B();if(n!=="admin"&&n!=="superadmin")return e.jsx("p",{children:"Ð£ Ð²Ð°Ñ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð² Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ð¾ÑÑ‚ÑÐ¼Ð¸."});const[d,u]=s.useState({}),[h,o]=s.useState(!0),[i,m]=s.useState(!1),[_,y]=s.useState(null),[p,f]=s.useState(null),j=()=>{o(!0);const c=localStorage.getItem("authToken");fetch("/api/admin/news",{headers:{Authorization:`Bearer ${c}`}}).then(async r=>{if(!r.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð¾Ð²Ð¾ÑÑ‚ÐµÐ¹");const g=await r.json();u(g)}).catch(r=>console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð¾Ð²Ð¾ÑÑ‚ÐµÐ¹:",r)).finally(()=>o(!1))};s.useEffect(()=>{j()},[]);const x=async()=>{if(!p)return;const c=localStorage.getItem("authToken");try{const r=await fetch(`/api/admin/news/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${c}`}});if(!r.ok){const g=await r.json();throw new Error(g?.error||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ð¾ÑÑ‚Ð¸")}f(null),j()}catch(r){alert(r.message)}};if(h)return e.jsx("p",{children:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð¾Ð²Ð¾ÑÑ‚ÐµÐ¹..."});const N=Object.entries(d);return e.jsxs("div",{className:"aam_news-manager",children:[e.jsx("h2",{children:"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð¾Ð²Ð¾ÑÑ‚ÑÐ¼Ð¸"}),e.jsx("button",{className:"aam-news-btn aam-news-btn--add",onClick:()=>m(!0),children:"âž• ÐÐ¾Ð²Ð°Ñ Ð½Ð¾Ð²Ð¾ÑÑ‚ÑŒ"}),N.length===0?e.jsx("p",{children:"ÐÐ¾Ð²Ð¾ÑÑ‚ÐµÐ¹ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚."}):e.jsxs("table",{className:"aam_news-manager__table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Slug"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Ð”Ð°Ñ‚Ð°"}),e.jsx("th",{children:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº (RU)"}),e.jsx("th",{children:"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ"})]})}),e.jsx("tbody",{children:N.map(([c,r])=>e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsx("td",{children:r.slug}),e.jsx("td",{children:r.priority}),e.jsx("td",{children:r.dates.date?new Date(r.dates.date).toLocaleDateString("ru-RU"):"-"}),e.jsx("td",{children:r.titles.ru||"-"}),e.jsxs("td",{children:[e.jsx("button",{className:"aam-news-btn aam-news-btn--edit",onClick:()=>y({id:c,...r}),children:"âœï¸"}),e.jsx("button",{className:"aam-news-btn aam-news-btn--delete",onClick:()=>f(c),children:"ðŸ—‘ï¸"})]})]},c))})]}),i&&e.jsx(L,{onClose:()=>m(!1),onCreated:j}),_&&e.jsx(M,{news:_,onClose:()=>y(null),onUpdated:j}),p&&e.jsx(P,{username:d[p]?.titles.ru||`ÐÐ¾Ð²Ð¾ÑÑ‚ÑŒ #${p}`,onConfirm:x,onCancel:()=>f(null)})]})}export{O as default};
//# sourceMappingURL=NewsManager-Bc3TZv2s.js.map
